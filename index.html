<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>norsk</title>
  </head>
  <body>
    <form id="form">
      <span id="question"></span>
      <input id="answer" required>
      <span id="solution"></span>
      <button>
        accept
      </button>
      <span id="points"></span>
      <span id="missed"></span>
      <button id="next" type="button">
        next
      </button>
    </form>
    <script>
      const form = document.getElementById('form')
      const question = document.getElementById('question')
      const answer = document.getElementById('answer')
      const solution = document.getElementById('solution')
      const points = document.getElementById('points')
      const missed = document.getElementById('missed')
      const next = document.getElementById('next')
      const german = 'german'
      const norsk = 'norsk'
      const languages = [german, norsk]
      const words = [
        { [german]: 'Hallo', [norsk]: 'Hei' },
        { [german]: 'Danke', [norsk]: 'Takk' },
        { [german]: 'Tschüss', [norsk]: 'Ha det' },
      ]

      const getRandomElement = list => list[Math.floor(Math.random() * list.length)]
      const getOtherLanguage = (language) => {
        if (language === german) {
          return norsk
        }

        return german
      }

      let currentWord = null
      let currentLanguage = null
      const drawNext = () => {
        const pool = currentWord ? words.filter(word => word.german !== currentWord.german) : words
        currentWord = getRandomElement(pool)
        currentLanguage = getRandomElement(languages)
      }

      let pointsCounter = 0
      let missedCounter = 0
      let madeAPoint = false

      form.addEventListener('submit', (e) => {
        e.preventDefault()
        e.stopPropagation()

        if (answer.value.toLowerCase() === currentWord[getOtherLanguage(currentLanguage)].toLowerCase()) {
          solution.innerText = '√'

          if (!madeAPoint) {
            pointsCounter += 1
            madeAPoint = true
            points.innerText = pointsCounter
          }
        } else {
          solution.innerText = 'x'
        }
      })

      next.addEventListener('click', () => {
        if (!madeAPoint) {
          missedCounter += 1
          madeAPoint = true
          missed.innerText = missedCounter
        }

        madeAPoint = false
        drawNext()
        question.innerText = currentWord[currentLanguage]
      })

      drawNext()
      points.innerText = pointsCounter
      missed.innerText = missedCounter
      question.innerText = currentWord[currentLanguage]
    </script>
  </body>
</html>
